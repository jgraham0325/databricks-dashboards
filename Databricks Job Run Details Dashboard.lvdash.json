{"datasets":[{"name":"8aa05585","displayName":"benchmarking-jobs-query","query":"WITH most_recent_jobs_cte AS (\n  SELECT \n    *, \n    ROW_NUMBER() OVER(PARTITION BY workspace_id, job_id ORDER BY change_time DESC) AS rn\n  FROM system.lakeflow.jobs \n  QUALIFY rn = 1\n),\n\nlist_cost_per_job_cte AS (\n  SELECT\n    u.workspace_id,\n    u.usage_metadata.job_id,\n    u.usage_metadata.cluster_id,\n    u.usage_metadata.job_run_id,\n    COUNT(DISTINCT u.usage_metadata.job_run_id) AS runs,\n    SUM(u.usage_quantity * list_prices.pricing.default) AS list_cost,\n    FIRST(identity_metadata.run_as, TRUE) AS run_as,\n    FIRST(u.custom_tags, TRUE) AS custom_tags,\n    MAX(u.usage_end_time) AS last_seen_date,\n    MAX(jrt.period_end_time) AS end_time\n  FROM system.billing.usage u \n  INNER JOIN system.billing.list_prices list_prices \n    ON u.cloud = list_prices.cloud \n    AND u.sku_name = list_prices.sku_name \n    AND u.usage_start_time >= list_prices.price_start_time \n    AND (u.usage_end_time <= list_prices.price_end_time OR list_prices.price_end_time IS NULL)\n  INNER JOIN system.lakeflow.job_run_timeline jrt \n    ON u.account_id = jrt.account_id\n    AND u.workspace_id = jrt.workspace_id\n    AND u.usage_metadata.job_id = jrt.job_id\n    AND u.usage_metadata.job_run_id = jrt.run_id\n    AND jrt.result_state = 'SUCCEEDED'\n  WHERE u.sku_name LIKE '%JOBS%'\n    AND u.sku_name NOT ILIKE '%jobs_serverless%'\n    AND u.usage_metadata.job_id IS NOT NULL\n    AND u.usage_date >= CURRENT_DATE() - INTERVAL 90 DAY \n  GROUP BY ALL\n),\n\njob_details_cte AS (\n  SELECT \n    mrj.name,\n    lcj.job_id,\n    lcj.job_run_id,\n    lcj.workspace_id,\n    lcj.cluster_id,\n    lcj.runs,\n    lcj.run_as,\n    lcj.last_seen_date,\n    lcj.end_time,\n    SUM(lcj.list_cost) AS list_cost\n  FROM list_cost_per_job_cte lcj\n  INNER JOIN most_recent_jobs_cte mrj \n    USING (workspace_id, job_id)\n  GROUP BY ALL\n  ORDER BY list_cost DESC\n),\n\ncluster_details_cte AS (\n  SELECT * \n  FROM system.compute.node_timeline\n  WHERE start_time >= CURRENT_DATE() - INTERVAL 90 DAY \n),\n\njob_details_with_cluster_metrics_cte AS (\n  SELECT \n    jd.workspace_id, \n    jd.name,\n    jd.job_id,\n    jd.cluster_id,\n    jd.job_run_id,\n    jd.last_seen_date,\n    jd.list_cost,\n    -- TODO: Create a mapping table for the workspace ids to urls, or update this hard coded list\n    CASE \n      WHEN jd.workspace_id = 7468896762649661 THEN 'https://adb-7468896762649661.1.azuredatabricks.net/jobs/' \n      WHEN jd.workspace_id = 792746016474130 THEN 'https://adb-792746016474130.10.azuredatabricks.net/jobs/' \n      ELSE 'unknown' \n    END || jd.job_id || '/runs/' || jd.job_run_id AS job_url,\n    jd.end_time,\n    AVG(cd.cpu_user_percent + cd.cpu_system_percent) AS avg_cpu_utilization, \n    MAX(cd.cpu_user_percent + cd.cpu_system_percent) AS peak_cpu_utilization, \n    AVG(cd.cpu_wait_percent) AS avg_cpu_disk_wait,\n    MAX(cd.cpu_wait_percent) AS max_cpu_disk_wait,\n    AVG(cd.mem_used_percent) AS avg_memory_utilization, \n    MAX(cd.mem_used_percent) AS max_memory_utilization\n  FROM job_details_cte jd\n  LEFT JOIN cluster_details_cte cd \n    ON jd.cluster_id = cd.cluster_id\n  GROUP BY ALL\n),\n\njob_details_with_cluster_metrics_and_duration_cte AS (\n  SELECT\n    jdcm.*,\n    c.create_time,\n    c.worker_count,\n    c.worker_node_type,\n    c.driver_node_type,\n    c.azure_attributes.availability,\n    (TO_UNIX_TIMESTAMP(jdcm.end_time) - TO_UNIX_TIMESTAMP(c.create_time)) / 3600.0 AS job_duration_hours,\n    CONCAT(\n      LPAD(FLOOR((TO_UNIX_TIMESTAMP(jdcm.end_time) - TO_UNIX_TIMESTAMP(c.create_time)) / 3600), 2, '0'),\n      ':',\n      LPAD(FLOOR(((TO_UNIX_TIMESTAMP(jdcm.end_time) - TO_UNIX_TIMESTAMP(c.create_time)) % 3600) / 60), 2, '0'),\n      ':',\n      LPAD((TO_UNIX_TIMESTAMP(jdcm.end_time) - TO_UNIX_TIMESTAMP(c.create_time)) % 60, 2, '0')\n    ) AS duration\n  FROM job_details_with_cluster_metrics_cte jdcm\n  JOIN system.compute.clusters c\n    ON jdcm.cluster_id = c.cluster_id\n)\n\nSELECT *\nFROM job_details_with_cluster_metrics_and_duration_cte\nORDER BY create_time DESC\nLIMIT 1000"}],"pages":[{"name":"42173fa8","displayName":"page1","layout":[{"widget":{"name":"72f70067","queries":[{"name":"main_query","query":{"datasetName":"8aa05585","fields":[{"name":"workspace_id","expression":"`workspace_id`"},{"name":"name","expression":"`name`"},{"name":"create_time","expression":"`create_time`"},{"name":"end_time","expression":"`end_time`"},{"name":"duration","expression":"`duration`"},{"name":"list_cost","expression":"`list_cost`"},{"name":"job_url","expression":"`job_url`"},{"name":"job_id","expression":"`job_id`"},{"name":"cluster_id","expression":"`cluster_id`"},{"name":"job_run_id","expression":"`job_run_id`"},{"name":"last_seen_date","expression":"`last_seen_date`"},{"name":"worker_count","expression":"`worker_count`"},{"name":"worker_node_type","expression":"`worker_node_type`"},{"name":"availability","expression":"`availability`"},{"name":"driver_node_type","expression":"`driver_node_type`"},{"name":"avg_cpu_utilization","expression":"`avg_cpu_utilization`"},{"name":"peak_cpu_utilization","expression":"`peak_cpu_utilization`"},{"name":"avg_cpu_disk_wait","expression":"`avg_cpu_disk_wait`"},{"name":"max_cpu_disk_wait","expression":"`max_cpu_disk_wait`"},{"name":"avg_memory_utilization","expression":"`avg_memory_utilization`"},{"name":"max_memory_utilization","expression":"`max_memory_utilization`"}],"disaggregated":true}}],"spec":{"version":1,"widgetType":"table","encodings":{"columns":[{"fieldName":"workspace_id","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":0,"title":"workspace_id","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"workspace_id"},{"fieldName":"name","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":1,"title":"name","allowSearch":true,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"name"},{"fieldName":"create_time","dateTimeFormat":"YYYY-MM-DD HH:mm:ss.SSS","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"datetime","displayAs":"datetime","visible":true,"order":2,"title":"create_time","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"create_time"},{"fieldName":"end_time","dateTimeFormat":"YYYY-MM-DD HH:mm:ss.SSS","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"datetime","displayAs":"datetime","visible":true,"order":3,"title":"end_time","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"end_time"},{"fieldName":"duration","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":4,"title":"duration","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"duration"},{"fieldName":"list_cost","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"decimal","displayAs":"number","visible":true,"order":5,"title":"list_cost (usd)","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"description":"DBU cost only, not VM costs","displayName":"list_cost"},{"fieldName":"job_url","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ job_id }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"link","visible":true,"order":6,"title":"job_id (link)","allowSearch":false,"alignContent":"left","allowHTML":true,"highlightLinks":true,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"job_url"},{"fieldName":"job_id","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":8,"title":"job_id","allowSearch":true,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"job_id"},{"fieldName":"cluster_id","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":9,"title":"cluster_id","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"cluster_id"},{"fieldName":"job_run_id","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":10,"title":"job_run_id","allowSearch":true,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"job_run_id"},{"fieldName":"last_seen_date","dateTimeFormat":"YYYY-MM-DD HH:mm:ss.SSS","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"datetime","displayAs":"datetime","visible":true,"order":11,"title":"last_seen_date","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"last_seen_date"},{"fieldName":"worker_count","numberFormat":"0","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"integer","displayAs":"number","visible":true,"order":12,"title":"worker_count","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"worker_count"},{"fieldName":"worker_node_type","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":13,"title":"worker_node_type","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"worker_node_type"},{"fieldName":"availability","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":14,"title":"availability","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"availability"},{"fieldName":"driver_node_type","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":15,"title":"driver_node_type","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"driver_node_type"},{"fieldName":"avg_cpu_utilization","numberFormat":"0.00","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"float","displayAs":"number","visible":true,"order":16,"title":"avg_cpu_utilization","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"avg_cpu_utilization"},{"fieldName":"peak_cpu_utilization","numberFormat":"0.00","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"float","displayAs":"number","visible":true,"order":17,"title":"peak_cpu_utilization","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"peak_cpu_utilization"},{"fieldName":"avg_cpu_disk_wait","numberFormat":"0.00","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"float","displayAs":"number","visible":true,"order":18,"title":"avg_cpu_disk_wait","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"avg_cpu_disk_wait"},{"fieldName":"max_cpu_disk_wait","numberFormat":"0.00","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"float","displayAs":"number","visible":true,"order":19,"title":"max_cpu_disk_wait","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"max_cpu_disk_wait"},{"fieldName":"avg_memory_utilization","numberFormat":"0.00","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"float","displayAs":"number","visible":true,"order":20,"title":"avg_memory_utilization","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"avg_memory_utilization"},{"fieldName":"max_memory_utilization","numberFormat":"0.00","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"float","displayAs":"number","visible":true,"order":21,"title":"max_memory_utilization","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"max_memory_utilization"}]},"invisibleColumns":[{"booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"name":"job_duration_hours","type":"decimal","displayAs":"number","order":7,"title":"job_duration_hours","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false}],"allowHTMLByDefault":false,"itemsPerPage":25,"paginationSize":"default","condensed":true,"withRowNumber":false,"frame":{"title":"Job run details (most recent first)","showTitle":true}}},"position":{"x":0,"y":5,"width":6,"height":11}},{"widget":{"name":"bf9169a6","queries":[{"name":"dashboards/01efa1de22a9198cb03f10b4739cdad9/datasets/01efa1de22aa1139bdbfbddd880fde82_name","query":{"datasetName":"8aa05585","fields":[{"name":"name","expression":"`name`"},{"name":"name_associativity","expression":"COUNT_IF(`associative_filter_predicate_group`)"}],"disaggregated":false}}],"spec":{"version":2,"widgetType":"filter-multi-select","encodings":{"fields":[{"fieldName":"name","displayName":"name","queryName":"dashboards/01efa1de22a9198cb03f10b4739cdad9/datasets/01efa1de22aa1139bdbfbddd880fde82_name"}]},"frame":{"showTitle":true,"title":"Job Name"}}},"position":{"x":0,"y":3,"width":2,"height":1}},{"widget":{"name":"5c99f5c9","queries":[{"name":"dashboards/01efa1de22a9198cb03f10b4739cdad9/datasets/01efa1de22aa1139bdbfbddd880fde82_create_time","query":{"datasetName":"8aa05585","fields":[{"name":"create_time","expression":"`create_time`"},{"name":"create_time_associativity","expression":"COUNT_IF(`associative_filter_predicate_group`)"}],"disaggregated":false}}],"spec":{"version":2,"widgetType":"filter-date-range-picker","encodings":{"fields":[{"fieldName":"create_time","displayName":"create_time","queryName":"dashboards/01efa1de22a9198cb03f10b4739cdad9/datasets/01efa1de22aa1139bdbfbddd880fde82_create_time"}]},"frame":{"showTitle":true,"title":"Job Create Time"}}},"position":{"x":2,"y":4,"width":2,"height":1}},{"widget":{"name":"ca0f7c89","queries":[{"name":"dashboards/01efa1de22a9198cb03f10b4739cdad9/datasets/01efa1de22aa1139bdbfbddd880fde82_job_id","query":{"datasetName":"8aa05585","fields":[{"name":"job_id","expression":"`job_id`"},{"name":"job_id_associativity","expression":"COUNT_IF(`associative_filter_predicate_group`)"}],"disaggregated":false}}],"spec":{"version":2,"widgetType":"filter-multi-select","encodings":{"fields":[{"fieldName":"job_id","displayName":"job_id","queryName":"dashboards/01efa1de22a9198cb03f10b4739cdad9/datasets/01efa1de22aa1139bdbfbddd880fde82_job_id"}]},"frame":{"showTitle":true,"title":"Job ID"}}},"position":{"x":2,"y":3,"width":2,"height":1}},{"widget":{"name":"8387df30","queries":[{"name":"main_query","query":{"datasetName":"8aa05585","fields":[{"name":"sum(list_cost)","expression":"SUM(`list_cost`)"},{"name":"name","expression":"`name`"}],"disaggregated":false}}],"spec":{"version":3,"widgetType":"bar","encodings":{"x":{"fieldName":"sum(list_cost)","scale":{"type":"quantitative"},"displayName":"Sum of list_cost"},"y":{"fieldName":"name","scale":{"type":"categorical","sort":{"by":"x-reversed"}},"displayName":"name"},"label":{"show":true}},"frame":{"title":"Total list cost per job","showTitle":true}}},"position":{"x":0,"y":32,"width":6,"height":8}},{"widget":{"name":"13b66418","queries":[{"name":"main_query","query":{"datasetName":"8aa05585","fields":[{"name":"avg(job_duration_hours)","expression":"AVG(`job_duration_hours`)"},{"name":"name","expression":"`name`"}],"disaggregated":false}}],"spec":{"version":3,"widgetType":"bar","encodings":{"x":{"fieldName":"avg(job_duration_hours)","scale":{"type":"quantitative"},"displayName":"Average job_duration_hours"},"y":{"fieldName":"name","scale":{"type":"categorical","sort":{"by":"x-reversed"}},"displayName":"name"},"label":{"show":true}},"frame":{"title":"Average duration by job run","showTitle":true}}},"position":{"x":0,"y":24,"width":6,"height":8}},{"widget":{"name":"88a81611","queries":[{"name":"main_query","query":{"datasetName":"8aa05585","fields":[{"name":"avg(list_cost)","expression":"AVG(`list_cost`)"},{"name":"name","expression":"`name`"}],"disaggregated":false}}],"spec":{"version":3,"widgetType":"bar","encodings":{"x":{"fieldName":"avg(list_cost)","scale":{"type":"quantitative"},"displayName":"Average list_cost"},"y":{"fieldName":"name","scale":{"type":"categorical"},"displayName":"name"},"label":{"show":true}},"frame":{"title":"Average list cost per job run","showTitle":true}}},"position":{"x":0,"y":16,"width":6,"height":8}},{"widget":{"name":"1dc4b84b","queries":[{"name":"dashboards/01efa1de22a9198cb03f10b4739cdad9/datasets/01efa1de22aa1139bdbfbddd880fde82_TestName","query":{"datasetName":"8aa05585","fields":[{"name":"TestName","expression":"`TestName`"}],"disaggregated":false}}],"spec":{"version":2,"widgetType":"filter-text-entry","encodings":{"fields":[{"fieldName":"TestName","displayName":"TestName","queryName":"dashboards/01efa1de22a9198cb03f10b4739cdad9/datasets/01efa1de22aa1139bdbfbddd880fde82_TestName"}]},"matchMode":"contains","frame":{"showTitle":true,"title":"Job Name Contains"}}},"position":{"x":4,"y":4,"width":2,"height":1}},{"widget":{"name":"52b78799","queries":[{"name":"main_query","query":{"datasetName":"8aa05585","fields":[{"name":"name","expression":"`name`"},{"name":"avg(job_duration_hours)","expression":"AVG(`job_duration_hours`)"},{"name":"avg(avg_memory_utilization)","expression":"AVG(`avg_memory_utilization`)"},{"name":"avg(avg_cpu_utilization)","expression":"AVG(`avg_cpu_utilization`)"},{"name":"count(*)","expression":"COUNT(`*`)"},{"name":"avg(list_cost)","expression":"AVG(`list_cost`)"}],"cubeGroupingSets":{"sets":[{},{"fieldNames":["name"]}]},"disaggregated":false,"orders":[{"direction":"ASC","expression":"`name`"}]}}],"spec":{"version":3,"widgetType":"pivot","encodings":{"columns":[{"fieldName":"name","displayName":"Job Name"}],"cell":{"type":"multi-cell","fields":[{"fieldName":"avg(job_duration_hours)","cellType":"text","displayName":"Average job_duration_hours"},{"fieldName":"avg(avg_memory_utilization)","cellType":"text","displayName":"Average memory utilisation"},{"fieldName":"avg(avg_cpu_utilization)","cellType":"text","displayName":"Average CPU utilisation"},{"fieldName":"count(*)","cellType":"text","displayName":"Count of Records"},{"fieldName":"avg(list_cost)","cellType":"text","displayName":"Average list_cost"}]}},"frame":{"title":"Job average values pivot","showTitle":true}}},"position":{"x":0,"y":40,"width":6,"height":7}},{"widget":{"name":"b64bea02","queries":[{"name":"main_query","query":{"datasetName":"8aa05585","fields":[{"name":"create_time","expression":"`create_time`"}],"disaggregated":true}}],"spec":{"version":2,"widgetType":"counter","encodings":{"value":{"fieldName":"create_time","rowNumber":0,"displayName":"create_time"}},"frame":{"showTitle":true,"title":"Latest Job Data (create_time):"}}},"position":{"x":0,"y":4,"width":2,"height":1}},{"widget":{"name":"5561ff47","queries":[{"name":"dashboards/01efdcfee3301477b82727f949a5e585/datasets/01efdcfee33018599353df5b536f3747_job_run_id","query":{"datasetName":"8aa05585","fields":[{"name":"job_run_id","expression":"`job_run_id`"},{"name":"job_run_id_associativity","expression":"COUNT_IF(`associative_filter_predicate_group`)"}],"disaggregated":false}}],"spec":{"version":2,"widgetType":"filter-single-select","encodings":{"fields":[{"fieldName":"job_run_id","displayName":"job_run_id","queryName":"dashboards/01efdcfee3301477b82727f949a5e585/datasets/01efdcfee33018599353df5b536f3747_job_run_id"}]},"frame":{"showTitle":true,"title":"Job Run ID"}}},"position":{"x":4,"y":3,"width":2,"height":1}},{"widget":{"name":"c258a2bc","textbox_spec":"# Databricks Job Run Details Dashboard\n**Purpose**: Provide granular details about Databricks jobs that have been run recently. Used for monitoring costs and comparing performance.\\\n**Usage**: Select the job you're interested in from the filters, or click on one of the bars in the bar chart below to filter the detailed table to that specific job. The details will show every recent run of the job (last 30 days)\\\n**Setup**: [optional] To get the hyperlinks in the table to work, edit the SQL query to include your workspace URLs, or create a lookup table for these."},"position":{"x":0,"y":0,"width":6,"height":3}}]}]}